# Laravelサービスクラス仕様書セクションテンプレート

注意事項:
1. 各セクションは可能な限り詳細に記入してください
2. 省略可能なセクションであっても、その旨を明記してください
3. テーブル構成やフィールドは省略せず、完全な形で記載してください
4. バリデーションルールは具体的な制約を含めて記載してください
5. エラーハンドリングは想定されるすべてのケースを記載してください
6. テストケースは境界値を含めて記載してください
7. イベントとリスナーは具体的な処理内容まで記載してください
8. 依存関係は必要なバージョンを含めて記載してください
9. トランザクション制御が必要な場合は、その範囲を明確に記載してください
10. セキュリティに関する考慮事項は必ず記載してください

---

# [機能名]仕様

## 概要
[この機能の目的と主な機能を簡潔に説明]

## 機能の対象
- オペレーター
- 管理者
[その他の対象ユーザー]

## 使用テーブル構成
1. **[メインテーブル名]**
   - **[モデル名]**（[テーブル名]）
     - フィールド:
       - `[フィールド名]`: [説明]
       - `[フィールド名]`: [説明]
       ...

     - モデルファイル: `[ファイル名].php`
     - マイグレーションファイル: `[ファイル名].php`
     - ユニークキー: `[キー名]`
     - インデックス: `[インデックス名]`

## 参照テーブル
1. **[参照テーブル名]**
   - **[モデル名]**（[テーブル名]）
     - フィールド:
       - `[フィールド名]`: [説明]
       - `[フィールド名]`: [説明]
       ...

     - モデルファイル: `[ファイル名].php`
     - マイグレーションファイル: `[ファイル名].php`
     - ユニークキー: `[キー名]`
     - インデックス: `[インデックス名]`

## 依存関係
- Laravelフレームワーク v11.0以上
- PHP 8.3以上
- データベース（MySQL 8.0以上）
- [その他の依存パッケージやシステム]
  - [パッケージ名]: [バージョン]
  - [必要な理由]

## バリデーションルール [該当する場合]
- **[テーブル名]**
  1. `[フィールド名]`: [ルール]
     - [具体的な制約]
     - [エラーメッセージ]
  2. `[フィールド名]`: [ルール]
     - [具体的な制約]
     - [エラーメッセージ]
  ...

## 機能を実行するサービスクラス
- クラス名: `App\Services\[パス]\[クラス名]`
- 名前空間: `App\Services\[パス]`
- 主要メソッド: 
  - `[メソッド名]([パラメータ]): [戻り値の型]`
    - パラメータ:
      - `[パラメータ名]`: [型] - [説明]
    - 戻り値: [型] - [説明]
    - 例外: [発生する可能性のある例外]

## イベント
1. **[イベント名]**
   - 名前空間: `App\Events\[パス]`
   - 発火タイミング: [タイミングの説明]
   - データ: [イベントで渡されるデータ]
   - 処理内容: [イベントの具体的な処理]

2. **[イベント名]**
   - 名前空間: `App\Events\[パス]`
   - 発火タイミング: [タイミングの説明]
   - データ: [イベントで渡されるデータ]
   - 処理内容: [イベントの具体的な処理]

## リスナー
1. **[リスナー名]**
   - 名前空間: `App\Listeners\[パス]`
   - 処理内容: [リスナーの処理内容]
   - イベント: [対応するイベント]
   - 優先順位: [実行優先順位]

2. **[リスナー名]**
   - 名前空間: `App\Listeners\[パス]`
   - 処理内容: [リスナーの処理内容]
   - イベント: [対応するイベント]
   - 優先順位: [実行優先順位]

## 機能のビジネスロジック
1. [ステップ1の名称]
   - 処理内容:
     - [具体的な処理の説明]
   - トランザクション範囲:
     - [トランザクションの開始位置]
     - [トランザクションの終了位置]
   - 例外処理:
     - [発生する可能性のある例外]
     - [例外発生時の処理]

2. [ステップ2の名称]
   - 処理内容:
     - [具体的な処理の説明]
   - トランザクション範囲:
     - [トランザクションの開始位置]
     - [トランザクションの終了位置]
   - 例外処理:
     - [発生する可能性のある例外]
     - [例外発生時の処理]

## エラーハンドリング
- 成功:
  - [成功パターン]
    - HTTPステータスコード: [コード]
    - レスポンス: [レスポンス内容]
    - レスポンス例: [JSONなどのレスポンス例]

- 失敗:
  - [エラーパターン1]
    - HTTPステータスコード: [コード]
    - エラーメッセージ: [メッセージ]
    - エラーコード: [エラーコード]
    - ログレベル: [ERROR/WARNING/INFO等]
    - 追加情報: [ログに記録する追加情報]
  
  - [エラーパターン2]
    - HTTPステータスコード: [コード]
    - エラーメッセージ: [メッセージ]
    - エラーコード: [エラーコード]
    - ログレベル: [ERROR/WARNING/INFO等]
    - 追加情報: [ログに記録する追加情報]

## テストケース
1. 正常系
   - [テストケース1]
     - 入力値: [テストデータ]
     - 期待結果: [期待される結果]
     - 確認項目: [テスト時の確認ポイント]
   
   - [テストケース2]
     - 入力値: [テストデータ]
     - 期待結果: [期待される結果]
     - 確認項目: [テスト時の確認ポイント]

2. 異常系
   - [エラーケース1]
     - 入力値: [テストデータ]
     - 期待結果: [期待されるエラー結果]
     - エラーメッセージ: [期待されるエラーメッセージ]
     - 確認項目: [テスト時の確認ポイント]
   
   - [エラーケース2]
     - 入力値: [テストデータ]
     - 期待結果: [期待されるエラー結果]
     - エラーメッセージ: [期待されるエラーメッセージ]
     - 確認項目: [テスト時の確認ポイント]

## その他
- セキュリティ対策:
  - [認証要件]
  - [認可要件]
  - [入力検証]
  - [CSRF対策]
  - [その他のセキュリティ考慮事項]

- パフォーマンス対策:
  - [キャッシュ戦略]
  - [インデックス最適化]
  - [N+1問題対策]

- 監視とログ:
  - [監視項目]
  - [ログ出力項目]
  - [アラート条件]

- 運用考慮事項:
  - [バックアップ要件]
  - [メンテナンス要件]
  - [障害復旧手順]

